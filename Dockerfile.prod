# ‡∏™‡πÄ‡∏ï‡∏à 1: Build Vue
FROM node:20 AS builder
WORKDIR /app

# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå dependencies ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
COPY package.json  ./
RUN npm install

# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞ Build
COPY . .
RUN npm run build  # ‡πÑ‡∏î‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô /app/dist

# ‡∏™‡πÄ‡∏ï‡∏à 2: ‡πÉ‡∏ä‡πâ Nginx ‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÑ‡∏ü‡∏•‡πå Static
FROM nginx:alpine
WORKDIR /app

# üî• ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ Copy ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå Static ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å Build ‡πÉ‡∏ô Container builder
COPY --from=builder /app/dist /app/dist

# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Nginx Config
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
